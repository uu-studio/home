<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>厂区 60 设备温湿度总览</title>
  <meta name="viewport" content="width=1920,initial-scale=1" />
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <style>
    :root{
      --w:1920px;
      --h:1080px;
      --headerH:72px;
      --rightW:400px;
      --gap:16px;
      --titleH:24px;
      --cardW:150px;
      --cardH:130px;
      --fz36:36px; --fz22:22px; --fz18:18px; --fz16:16px; --fz14:14px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{width:var(--w);height:var(--h);overflow:hidden;font-family:"PingFang SC",Arial,sans-serif;background:#0e1a25;color:#fff}
    .header{display:flex;align-items:center;justify-content:space-between;padding:0 40px;height:var(--headerH);background:#132935;font-size:var(--fz36)}
    .main{display:flex;height:calc(var(--h) - var(--headerH))}
    .left{flex:1;display:flex;flex-direction:column;overflow:hidden}
    .zone{flex:none;margin-bottom:var(--gap)}
    .zone-title{height:var(--titleH);line-height:var(--titleH);font-size:var(--fz18);margin:0 0 6px 12px;color:#8ca0b3}
    .cards{display:grid;grid-template-columns:repeat(10,1fr);gap:var(--gap);padding:0 var(--gap)}
    .card{background:#1c2e3d;border-radius:6px;padding:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;width:var(--cardW);height:var(--cardH)}
    .card .dev{font-size:var(--fz14);color:#8ca0b3;margin-bottom:4px;text-align:center;white-space:nowrap}
    .card .row{display:flex;align-items:baseline;gap:4px}
    .card .value{font-size:var(--fz16);font-weight:700}
    .card .unit{font-size:var(--fz14);color:#8ca0b3}
    .temp{color:#ff9f1c}
    .humi{color:#2ec4b6}
    .status{position:absolute;top:4px;right:4px;width:8px;height:8px;border-radius:50%;background:#2ec4b6}
    .status.abnormal{background:#ff4d4f;box-shadow:0 0 4px #ff4d4f}
    .right{width:var(--rightW);background:#132935;display:flex;flex-direction:column;padding:12px}
    .right h3{font-size:var(--fz18);margin-bottom:6px;font-weight:400;color:#8ca0b3}
    .alarm-list{flex:1;overflow-y:auto}
    .alarm-item{background:#1c2e3d;border-radius:4px;padding:6px;margin-bottom:4px;font-size:var(--fz14)}
    .alarm-item .time{font-size:var(--fz14);color:#8ca0b3;margin-right:6px}
  </style>
</head>
<body>
  <div id="app">
    <header class="header">
      <span>厂区 60 设备温湿度总览</span>
      <span class="time">{{ now }}</span>
    </header>

    <div class="main">
      <div class="left">
        <div class="zone" v-for="(zone,name) in grouped" :key="name">
          <div class="zone-title">{{ name }}</div>
          <div class="cards">
            <div class="card" v-for="d in zone" :key="d.id">
              <span class="status" :class="{abnormal:d.abnormal}"></span>
              <div class="dev">{{ d.dev }}</div>
              <div class="row">
                <span class="value temp">{{ d.temp.toFixed(1) }}</span>
                <span class="unit">℃</span>
                <span class="value humi" style="margin-left:8px">{{ d.humi.toFixed(1) }}</span>
                <span class="unit">%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="right">
        <h3>实时报警</h3>
        <div class="alarm-list">
          <div class="alarm-item" v-for="a in alarms" :key="a.id">
            <span class="time">{{ a.time }}</span>
            <span>{{ a.dev }}</span>
            <span style="color:#ff9f1c"> 温度{{ a.temp }}℃</span>
            <span style="color:#2ec4b6"> 湿度{{ a.humi }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, reactive, computed } = Vue
    createApp({
      setup() {
        const zones = ['成型车间','干燥车间','仓库','中央空调站','机房','实验室']
        const devNames = []
        zones.forEach(z => { for(let i=1;i<=10;i++) devNames.push(`${z}-${i}#`) })
        const devices = reactive(
          devNames.map((d,idx) => ({
            id: idx,
            dev: d,
            zone: d.split('-')[0],
            temp: 22 + Math.random() * 16,
            humi: 40 + Math.random() * 30,
            get abnormal() { return this.temp > 35 || this.humi > 65 }
          }))
        )
        const alarms = reactive([])
        const pushAlarm = d => {
          alarms.unshift({ id: Date.now() + d.id, time: new Date().toLocaleTimeString('zh-CN'), dev: d.dev, temp: d.temp.toFixed(1), humi: d.humi.toFixed(1) })
          if (alarms.length > 200) alarms.pop()
        }
        const grouped = computed(() => {
          const map = {}
          devices.forEach(d => { if (!map[d.zone]) map[d.zone] = []; map[d.zone].push(d) })
          return map
        })
        const updateData = () => {
          devices.forEach(d => {
            const oldAbn = d.abnormal
            d.temp = 22 + Math.random() * 16
            d.humi = 40 + Math.random() * 30
            if (d.abnormal && !oldAbn) pushAlarm(d)
          })
        }
        setInterval(updateData, 2000)
        setInterval(() => { document.querySelector('.time').textContent = new Date().toLocaleString('zh-CN') }, 1000)
        return { now: new Date().toLocaleString('zh-CN'), grouped, alarms }
      }
    }).mount('#app')
  </script>
</body>
</html>
